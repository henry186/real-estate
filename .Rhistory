y=lat,
group=group,
fill=max),
color="black",
size=0.25)+
scale_fill_gradientn(
colours = brewer.pal(9,"Reds"))+
theme_void()+
coord_map()+
labs(title = "max price of the real estate")
return(priceMaxMap)
}
else if(choosemap=="min")
{
#minplot
#calculate the min value of price/square meters
priceMin<-ddply(taiwan,.(id),summarise,min=min(PricePerSqrtm,na.rm = T))
min_plot<-left_join(NameIdTable,priceMin,by= "id")
minPlot<-inner_join(taiwanmap.county,min_plot,by="id")
priceMinMap<-ggplot()+geom_polygon(data = minPlot,
aes(x=long,
y=lat,
group=group,
fill=min),
color="black",
size=0.25)+
scale_fill_gradientn(
colours = brewer.pal(9,"Reds"))+
theme_void()+
coord_map()+
labs(title = "min price of the real estate")
return(priceMinMap)
}
#population map
else if (choosemap=="population")
{
population<-readPopulation(year)
population_plot<-right_join(population,NameIdTable,by="name")
populationPlot<-right_join(population_plot,taiwanmap.county,by="id")
options(scipen = 999)
populationMap<-ggplot()+geom_polygon(data = populationPlot,
aes(x=long,
y=lat,
group=group,
fill=population),
color="black",
size=0.25)+
scale_fill_gradientn(
colours = brewer.pal(9,"Reds"))+
theme_void()+
coord_map()+
labs(title = "")
return(populationMap)
}
}
grid.arrange(plotmap(taiwan,"mean"),
plotmap(taiwan,"max"),
plotmap(taiwan,"population"),
nrow = 2)
plotmap(taiwan,"population")
year=109
population<-readPopulation(year)
population_plot<-right_join(population,NameIdTable,by="name")
#remove the Spratly Islands and Pratas Island
NameIdTable <- data.frame(id = taiwanmap$COUNTYID,
name = taiwanmap$COUNTYNAME,
stringsAsFactors = F)
NameIdTable<-unique(NameIdTable)  #delete
population_plot<-right_join(population,NameIdTable,by="name")
taiwanmap.county<-fortify(taiwanmap,region = "COUNTYID")  #transform shpdf to df
x<-which(taiwanmap.county$lat<=20)
taiwanmap.county<-taiwanmap.county[-x,]
options(scipen = 999)
population<-readPopulation(year)
View(NameIdTable)
View(population)
View(population_plot)
View(NameIdTable)
plotmap<-function(taiwan=taiwan,choosemap,year=109)
{
taiwanmap<-readShapeSpatial("twmapdata/TOWN_MOI_1090324.shp")        #readshpfile
taiwanmap.county<-fortify(taiwanmap,region = "COUNTYID")  #transform shpdf to df
#transform the encoding
taiwanmap$COUNTYNAME<- iconv(taiwanmap$COUNTYNAME,from = "UTF-8", to ="CP950")
#remove the Spratly Islands and Pratas Island
NameIdTable <- data.frame(id = taiwanmap$COUNTYID,
name = taiwanmap$COUNTYNAME,
stringsAsFactors = F)
NameIdTable<-unique(NameIdTable)  #delete
x<-which(taiwanmap.county$lat<=20)
taiwanmap.county<-taiwanmap.county[-x,]
options(scipen = 999)
if(choosemap=="mean")
{
#meanplot
#calculate the avg of price/squaremeters
priceMean<-ddply(taiwan,.(id),summarize,mean = round(mean(PricePerSqrtm,na.rm = T)))
mean_plot<-right_join(priceMean,NameIdTable,by= "id")
meanPlot<-inner_join(taiwanmap.county,mean_plot,by="id")
priceMeanMap<-ggplot()+geom_polygon(data = meanPlot,
aes(x=long,
y=lat,
group=group,
fill=mean),
color="black",
size=0.25)+
scale_fill_gradientn(
colours = brewer.pal(9,"Reds"))+
theme_void()+
coord_map()+
labs(title = "mean price of the real estate")
return(priceMeanMap)
}
else if(choosemap=="max")
{
#maxplot
#calculate the max value of price/square meters
priceMax<-ddply(taiwan,.(id),summarise,max=max(PricePerSqrtm,na.rm = T))
max_plot<-left_join(NameIdTable,priceMax,by= "id")
maxPlot<-inner_join(taiwanmap.county,max_plot,by="id")
priceMaxMap<-ggplot()+geom_polygon(data = maxPlot,
aes(x=long,
y=lat,
group=group,
fill=max),
color="black",
size=0.25)+
scale_fill_gradientn(
colours = brewer.pal(9,"Reds"))+
theme_void()+
coord_map()+
labs(title = "max price of the real estate")
return(priceMaxMap)
}
else if(choosemap=="min")
{
#minplot
#calculate the min value of price/square meters
priceMin<-ddply(taiwan,.(id),summarise,min=min(PricePerSqrtm,na.rm = T))
min_plot<-left_join(NameIdTable,priceMin,by= "id")
minPlot<-inner_join(taiwanmap.county,min_plot,by="id")
priceMinMap<-ggplot()+geom_polygon(data = minPlot,
aes(x=long,
y=lat,
group=group,
fill=min),
color="black",
size=0.25)+
scale_fill_gradientn(
colours = brewer.pal(9,"Reds"))+
theme_void()+
coord_map()+
labs(title = "min price of the real estate")
return(priceMinMap)
}
#population map
else if (choosemap=="population")
{
population<-readPopulation(year)
population_plot<-right_join(population,NameIdTable,by="name")
populationPlot<-right_join(population_plot,taiwanmap.county,by="id")
populationMap<-ggplot()+geom_polygon(data = populationPlot,
aes(x=long,
y=lat,
group=group,
fill=population),
color="black",
size=0.25)+
scale_fill_gradientn(
colours = brewer.pal(9,"Reds"))+
theme_void()+
coord_map()+
labs(title = "")
return(populationMap)
}
}
grid.arrange(plotmap(taiwan,"mean"),
plotmap(taiwan,"max"),
plotmap(taiwan,"population"),
nrow = 2)
View(taiwanmap.county)
View(NameIdTable)
plotmap<-function(taiwan=taiwan,choosemap,year=109)
{
taiwanmap<-readShapeSpatial("twmapdata/TOWN_MOI_1090324.shp")        #readshpfile
taiwanmap.county<-fortify(taiwanmap,region = "COUNTYID")  #transform shpdf to df
#transform the encoding
taiwanmap$COUNTYNAME<- iconv(taiwanmap$COUNTYNAME,from = "UTF-8", to ="CP950")
#remove the Spratly Islands and Pratas Island
NameIdTable <- data.frame(id = taiwanmap$COUNTYID,
name = taiwanmap$COUNTYNAME,
stringsAsFactors = F)
NameIdTable<-unique(NameIdTable)  #delete
x<-which(taiwanmap.county$lat<=20)
taiwanmap.county<-taiwanmap.county[-x,]
options(scipen = 999)
if(choosemap=="mean")
{
#meanplot
#calculate the avg of price/squaremeters
priceMean<-ddply(taiwan,.(id),summarize,mean = round(mean(PricePerSqrtm,na.rm = T)))
mean_plot<-right_join(priceMean,NameIdTable,by= "id")
meanPlot<-inner_join(taiwanmap.county,mean_plot,by="id")
priceMeanMap<-ggplot()+geom_polygon(data = meanPlot,
aes(x=long,
y=lat,
group=group,
fill=mean),
color="black",
size=0.25)+
scale_fill_gradientn(
colours = brewer.pal(9,"Reds"))+
theme_void()+
coord_map()+
labs(title = "mean price of the real estate")
return(priceMeanMap)
}
else if(choosemap=="max")
{
#maxplot
#calculate the max value of price/square meters
priceMax<-ddply(taiwan,.(id),summarise,max=max(PricePerSqrtm,na.rm = T))
max_plot<-left_join(NameIdTable,priceMax,by= "id")
maxPlot<-inner_join(taiwanmap.county,max_plot,by="id")
priceMaxMap<-ggplot()+geom_polygon(data = maxPlot,
aes(x=long,
y=lat,
group=group,
fill=max),
color="black",
size=0.25)+
scale_fill_gradientn(
colours = brewer.pal(9,"Reds"))+
theme_void()+
coord_map()+
labs(title = "max price of the real estate")
return(priceMaxMap)
}
else if(choosemap=="min")
{
#minplot
#calculate the min value of price/square meters
priceMin<-ddply(taiwan,.(id),summarise,min=min(PricePerSqrtm,na.rm = T))
min_plot<-left_join(NameIdTable,priceMin,by= "id")
minPlot<-inner_join(taiwanmap.county,min_plot,by="id")
priceMinMap<-ggplot()+geom_polygon(data = minPlot,
aes(x=long,
y=lat,
group=group,
fill=min),
color="black",
size=0.25)+
scale_fill_gradientn(
colours = brewer.pal(9,"Reds"))+
theme_void()+
coord_map()+
labs(title = "min price of the real estate")
return(priceMinMap)
}
#population map
else if (choosemap=="population")
{
population<-readPopulation(year)
population_plot<-right_join(population,NameIdTable,by="name")
populationPlot<-right_join(population_plot,taiwanmap.county,by="id")
populationMap<-ggplot()+geom_polygon(data = populationPlot,
aes(x=long,
y=lat,
group=group,
fill=population),
color="black",
size=0.25)+
theme_void()+
coord_map()+
labs(title = "county name")
return(populationMap)
}
else if (choosemap=="name")
{
namePlot<-right_join(NameIdTable,taiwanmap.county,by="id")
nameMap<-ggplot()+geom_polygon(data = namePlot,
aes(x=long,
y=lat,
group=group,
fill=name),
color="black",
size=0.25)+
scale_fill_gradientn(
colours = brewer.pal(9,"Reds"))+
theme_void()+
coord_map()+
labs(title = "")
return(nameMap)
}
}
plotmap(taiwan,"name")
namePlot<-right_join(NameIdTable,taiwanmap.county,by="id")
View(namePlot)
#transform the encoding
taiwanmap$COUNTYNAME<- iconv(taiwanmap$COUNTYNAME,from = "UTF-8", to ="CP950")
#remove the Spratly Islands and Pratas Island
NameIdTable <- data.frame(id = taiwanmap$COUNTYID,
name = taiwanmap$COUNTYNAME,
stringsAsFactors = F)
NameIdTable<-unique(NameIdTable)  #delete
x<-which(taiwanmap.county$lat<=20)
taiwanmap.county<-taiwanmap.county[-x,]
namePlot<-right_join(NameIdTable,taiwanmap.county,by="id")
nameMap<-ggplot()+geom_polygon(data = namePlot,
aes(x=long,
y=lat,
group=group,
fill=name),
color="black",
size=0.25)+
scale_fill_gradientn(
colours = brewer.pal(9,"Reds"))+
theme_void()+
coord_map()+
labs(title = "")
View(nameMap)
View(namePlot)
View(NameIdTable)
View(taiwanmap.county)
taiwanmap.county<-fortify(taiwanmap,region = "COUNTYID")  #transform shpdf to df
#transform the encoding
taiwanmap$COUNTYNAME<- iconv(taiwanmap$COUNTYNAME,from = "UTF-8", to ="CP950")
#remove the Spratly Islands and Pratas Island
NameIdTable <- data.frame(id = taiwanmap$COUNTYID,
name = taiwanmap$COUNTYNAME,
stringsAsFactors = F)
NameIdTable<-unique(NameIdTable)  #delete
x<-which(taiwanmap.county$lat<=20)
taiwanmap.county<-taiwanmap.county[-x,]
namePlot<-right_join(NameIdTable,taiwanmap.county,by="id")
nameMap<-ggplot()+geom_polygon(data = namePlot,
aes(x=long,
y=lat,
group=group,
fill=name),
color="black",
size=0.25)+
scale_fill_gradientn(
colours = brewer.pal(9,"Reds"))+
theme_void()+
coord_map()+
labs(title = "")
View(namePlot)
View(NameIdTable)
#remove the Spratly Islands and Pratas Island
NameIdTable <- data.frame(id = taiwanmap$COUNTYID,
name = taiwanmap$COUNTYNAME,
stringsAsFactors = F)
View(NameIdTable)
taiwanmap<-readShapeSpatial("twmapdata/TOWN_MOI_1090324.shp")        #readshpfile
#remove the Spratly Islands and Pratas Island
NameIdTable <- data.frame(id = taiwanmap$COUNTYID,
name = taiwanmap$COUNTYNAME,
stringsAsFactors = F)
View(NameIdTable)
#transform the encoding
taiwanmap$COUNTYNAME<- iconv(taiwanmap$COUNTYNAME,from = "UTF-8", to ="CP950")
#remove the Spratly Islands and Pratas Island
NameIdTable <- data.frame(id = taiwanmap$COUNTYID,
name = taiwanmap$COUNTYNAME,
stringsAsFactors = F)
View(NameIdTable)
NameIdTable<-unique(NameIdTable)  #delete repeat rows
View(NameIdTable)
namePlot<-right_join(NameIdTable,taiwanmap.county,by="id")
View(NameIdTable)
View(namePlot)
nameMap<-ggplot()+geom_polygon(data = namePlot,
aes(x=long,
y=lat,
group=group,
fill=name),
color="black",
size=0.25)+
scale_fill_gradientn(
colours = brewer.pal(9,"Reds"))+
theme_void()+
coord_map()+
labs(title = "")
nameMap
priceMean<-ddply(taiwan,.(id),summarize,mean = round(mean(PricePerSqrtm,na.rm = T)))
View(priceMean)
priceMean<-ddply(taiwan,.(id),mean = round(mean(PricePerSqrtm,na.rm = T)))
View(priceMean)
priceMean<-ddply(taiwan,.(id),mean = round(mean(PricePerSqrtm,na.rm = T)))
View(priceMean)
source('~/real-estate/Taiwan-estate.r')
source('~/real-estate/Taiwan-estate.r')
plotmap(taiwan,"mean")
plotAllMap<-function()
{
grid.arrange(plotmap(taiwan,"mean"),
plotmap(taiwan,"population"),
nrow = 2)
}
plotAllMap()
plotmap<-function(taiwan=taiwan,choosemap,year=109)
{
taiwanmap<-readShapeSpatial("twmapdata/TOWN_MOI_1090324.shp")        #readshpfile
taiwanmap.county<-fortify(taiwanmap,region = "COUNTYID")  #transform shpdf to df
#transform the encoding
taiwanmap$COUNTYNAME<- iconv(taiwanmap$COUNTYNAME,from = "UTF-8", to ="CP950")
#remove the Spratly Islands and Pratas Island
NameIdTable <- data.frame(id = taiwanmap$COUNTYID,
name = taiwanmap$COUNTYNAME,
stringsAsFactors = F)
NameIdTable<-unique(NameIdTable)  #delete repeat rows
x<-which(taiwanmap.county$lat<=20)
taiwanmap.county<-taiwanmap.county[-x,]
options(scipen = 999)
if(choosemap=="mean")
{
#meanplot
#calculate the avg of price/squaremeters
priceMean<-ddply(taiwan,.(id),summarize,mean = round(mean(PricePerSqrtm,na.rm = T)))
mean_plot<-right_join(priceMean,NameIdTable,by= "id")
meanPlot<-inner_join(taiwanmap.county,mean_plot,by="id")
priceMeanMap<-ggplot()+geom_polygon(data = meanPlot,
aes(x=long,
y=lat,
group=group,
fill=mean),
color="black",
size=0.25)+
scale_fill_gradientn(
colours = brewer.pal(9,"Reds"))+
theme_void()+
coord_map()+
labs(title = "mean price of the real estate")
return(priceMeanMap)
}
else if(choosemap=="max")
{
#maxplot
#calculate the max value of price/square meters
priceMax<-ddply(taiwan,.(id),summarise,max=max(PricePerSqrtm,na.rm = T))
max_plot<-left_join(NameIdTable,priceMax,by= "id")
maxPlot<-inner_join(taiwanmap.county,max_plot,by="id")
priceMaxMap<-ggplot()+geom_polygon(data = maxPlot,
aes(x=long,
y=lat,
group=group,
fill=max),
color="black",
size=0.25)+
scale_fill_gradientn(
colours = brewer.pal(9,"Reds"))+
theme_void()+
coord_map()+
labs(title = "max price of the real estate")
return(priceMaxMap)
}
else if(choosemap=="min")
{
#minplot
#calculate the min value of price/square meters
priceMin<-ddply(taiwan,.(id),summarise,min=min(PricePerSqrtm,na.rm = T))
min_plot<-left_join(NameIdTable,priceMin,by= "id")
minPlot<-inner_join(taiwanmap.county,min_plot,by="id")
priceMinMap<-ggplot()+geom_polygon(data = minPlot,
aes(x=long,
y=lat,
group=group,
fill=min),
color="black",
size=0.25)+
scale_fill_gradientn(
colours = brewer.pal(9,"Reds"))+
theme_void()+
coord_map()+
labs(title = "min price of the real estate")
return(priceMinMap)
}
#population map
else if (choosemap=="population")
{
population<-readPopulation(year)
population_plot<-right_join(population,NameIdTable,by="name")
populationPlot<-right_join(population_plot,taiwanmap.county,by="id")
populationMap<-ggplot()+geom_polygon(data = populationPlot,
aes(x=long,
y=lat,
group=group,
fill=population),
color="black",
size=0.25)+
scale_fill_gradientn(
colours = brewer.pal(9,"Reds"))+
theme_void()+
coord_map()+
labs(title = "population of taiwan")
return(populationMap)
}
}
plotAllMap()
plotAllMap<-function()
{
grid.arrange(plotmap(taiwan,"mean"),
plotmap(taiwan,"population"))
}
plotAllMap()
plotAllMap<-function()
{
grid.arrange(plotmap(taiwan,"mean"),
plotmap(taiwan,"population"),nrow=1)
}
plotAllMap()
